<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bug Life</title>

  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/nv.d3.min.css">

  <!-- TODO: replace with cdn version before deploy -->
  <script src="js/vendor/jquery-1.11.1.min.js"></script>
  <script src="js/vendor/base64.js"></script>
  <script src="js/vendor/underscore-min.js"></script>
  <script src="js/vendor/github-custom.js"></script>
  <script src="js/vendor/d3.js"></script>
  <script src="js/vendor/nv.d3.js"></script>

  <script src="js/parser.js"></script>
  <script src="js/visuals.js"></script>
  <script>
    $(function(){
      var parser = new Parser()
        , visuals = new Visuals('graph')
        , $repository = $('#repository')

      parser.beforeParse = function(){
        visuals.showLoading()
      }

      parser.afterParse = function(data){
        visuals.showData(data)
      }

      parser.onError = function(){
        visuals.showError()
      }

      parser.onProgress = function(progress){
        console.log('Progress', progress)
      }

      // On form submit
      $('#repository-form').submit(function(ev){
        ev.preventDefault()

        if ($repository.val()) {
          parser.parse($repository.val())
        }
      })

      // If initially form has a value
      if ($repository.val()) {
        parser.parse($repository.val())
      }
    })
  </script>
</head>
<body>
  <form action="" id="repository-form">
    <input type="text" name="repository" id="repository" placeholder="Insert repository url" value="TUM-FAF/FAFSite">
    <button type="submit">Submit</button>
  </form>
  <div id="stackedArea" class="stackedArea" style="width: 100%">
    <svg style="height: 500px"></svg>
  </div>
  <div id="semiCircles" class="semiCircles" style="width: 100%">
    <svg style="height: 500px"></svg>
  </div>
</body>
</html>
